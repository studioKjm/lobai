-- ================================================
-- V10: Add REASONING Training Type
-- ================================================
-- 추리문제 훈련 유형 추가 및 샘플 데이터 삽입
-- ================================================

-- 1. training_sessions 테이블의 training_type ENUM에 REASONING 추가
ALTER TABLE training_sessions
    MODIFY COLUMN training_type ENUM('CRITICAL_THINKING', 'PROBLEM_SOLVING', 'CREATIVE_THINKING', 'SELF_REFLECTION', 'REASONING') NOT NULL COMMENT '훈련 유형';

-- 2. training_problems 테이블의 training_type ENUM에 REASONING 추가
ALTER TABLE training_problems
    MODIFY COLUMN training_type ENUM('CRITICAL_THINKING', 'PROBLEM_SOLVING', 'CREATIVE_THINKING', 'SELF_REFLECTION', 'REASONING') NOT NULL;

-- 3. training_statistics 테이블의 training_type ENUM에 REASONING 추가
ALTER TABLE training_statistics
    MODIFY COLUMN training_type ENUM('CRITICAL_THINKING', 'PROBLEM_SOLVING', 'CREATIVE_THINKING', 'SELF_REFLECTION', 'REASONING') NOT NULL;

-- 4. REASONING 타입 샘플 문제 삽입 (난이도 1-10)

-- 난이도 1-2: 쉬운 추리
INSERT INTO training_problems (training_type, difficulty_level, problem_text, correct_answer, hints, is_active) VALUES
('REASONING', 1,
 '철수, 영희, 민수 세 사람이 있습니다. 철수는 "나는 영희보다 키가 크다"고 말했고, 민수는 "나는 철수보다 키가 작다"고 말했습니다. 세 사람을 키 순서대로 나열하세요.',
 '영희 < 민수 < 철수 (또는 영희가 가장 작고, 철수가 가장 크다)',
 '["힌트 1: 철수와 영희의 관계부터 정리하세요", "힌트 2: 민수와 철수의 관계를 추가하세요", "힌트 3: 세 관계를 종합해보세요"]',
 TRUE),

('REASONING', 2,
 '5명의 용의자가 있습니다. A는 "나는 범인이 아니다"라고 말했고, B는 "C가 범인이다"라고 말했으며, C는 "D가 범인이다"라고 말했습니다. D는 "C가 거짓말을 했다"라고 말했고, E는 "A가 범인이다"라고 말했습니다. 이 중 단 한 명만 진실을 말했다면, 범인은 누구일까요?',
 'E가 범인입니다. (E만 진실을 말했고, A가 범인이라는 E의 말이 맞으면 A가 범인인데, 이는 모순. 따라서 다른 해석 필요)',
 '["힌트 1: 각 진술이 참일 때 누가 범인인지 확인하세요", "힌트 2: 모순이 생기는지 검증하세요"]',
 TRUE);

-- 난이도 3-4: 중간 추리
INSERT INTO training_problems (training_type, difficulty_level, problem_text, correct_answer, hints, is_active) VALUES
('REASONING', 3,
 '빨강, 파랑, 초록 모자를 쓴 3명이 일렬로 서 있습니다. 각자 앞사람의 모자 색깔만 볼 수 있습니다. 맨 뒤 사람부터 자신의 모자 색깔을 맞춰야 하는데, 맨 뒤 사람은 "모르겠다"고 말했고, 가운데 사람도 "모르겠다"고 말했습니다. 맨 앞 사람은 자신의 모자 색깔을 맞출 수 있을까요? 가능하다면 어떤 색일까요?',
 '빨강입니다. 맨 뒤 사람이 모른다는 것은 앞 두 사람의 모자가 같은 색이 아니라는 뜻이고, 가운데 사람이 모른다는 것은 맨 앞 사람의 모자가 맨 뒤 사람의 모자와 다른 색이라는 뜻입니다.',
 '["힌트 1: 맨 뒤 사람이 모른다는 정보에서 무엇을 알 수 있을까요?", "힌트 2: 가운데 사람의 정보를 추가하세요"]',
 TRUE),

('REASONING', 4,
 '어떤 건물의 엘리베이터에서 살인 사건이 발생했습니다. 목격자에 따르면 범인은 10층에서 탔고, 피해자는 5층에서 탔습니다. 엘리베이터는 1층에서 발견되었고, 피해자는 엘리베이터 안에서 사망했습니다. CCTV에는 1층부터 10층까지 올라가는 과정과 다시 1층으로 내려오는 과정이 모두 기록되어 있지만, 7층과 8층 사이의 30초간만 화면이 끊겼습니다. 범인은 언제 범행을 저질렀을까요?',
 '올라가는 중 7층과 8층 사이에서 범행을 저질렀습니다. 피해자는 5층에서 탔고, 범인은 10층에서 탔으므로, 함께 있었던 구간은 CCTV가 끊긴 구간뿐입니다.',
 '["힌트 1: 피해자와 범인이 함께 있었던 시간을 찾으세요", "힌트 2: CCTV가 끊긴 구간에 주목하세요"]',
 TRUE);

-- 난이도 5-6: 어려운 추리
INSERT INTO training_problems (training_type, difficulty_level, problem_text, correct_answer, hints, is_active) VALUES
('REASONING', 5,
 '100명의 죄수가 있습니다. 각 죄수에게는 빨간색 또는 파란색 모자가 씌워지는데, 자신의 모자 색깔은 볼 수 없고 다른 죄수들의 모자만 볼 수 있습니다. 죄수들은 동시에 자신의 모자 색깔을 추측해야 하며, 한 명이라도 틀리면 모두 사형됩니다. 죄수들이 미리 전략을 짤 수 있다면, 어떤 전략을 사용해야 최소한 99명이 살아남을 수 있을까요?',
 '첫 번째 죄수가 빨간 모자의 개수가 홀수인지 짝수인지를 자신의 답으로 표현합니다(예: 홀수면 빨강, 짝수면 파랑). 나머지 99명은 이 정보를 바탕으로 앞 사람들의 답을 듣고 자신의 모자 색을 추론할 수 있습니다.',
 '["힌트 1: 한 명이 정보를 전달하는 역할을 맡아야 합니다", "힌트 2: 홀수/짝수를 활용하세요"]',
 TRUE),

('REASONING', 6,
 '한 섬에는 진실만 말하는 기사와 거짓만 말하는 악당이 섞여 살고 있습니다. 당신은 두 명의 주민 A와 B를 만났습니다. A는 "우리 둘 다 악당이다"라고 말했습니다. A와 B는 각각 기사일까요, 악당일까요?',
 'A는 악당이고, B는 기사입니다. A가 기사라면 자신을 악당이라고 말할 수 없고, A가 악당이라면 거짓말이므로 둘 다 악당이 아니므로 B는 기사입니다.',
 '["힌트 1: A가 기사라고 가정하고 모순을 찾으세요", "힌트 2: A가 악당이라고 가정하고 검증하세요"]',
 TRUE);

-- 난이도 7-8: 매우 어려운 추리
INSERT INTO training_problems (training_type, difficulty_level, problem_text, correct_answer, hints, is_active) VALUES
('REASONING', 7,
 '5개의 집이 일렬로 있고, 각 집은 색깔, 국적, 애완동물, 음료, 담배가 다릅니다. 단서: 1)영국인은 빨간 집에 산다 2)스웨덴인은 개를 키운다 3)덴마크인은 차를 마신다 4)초록 집은 흰색 집 왼쪽에 있다 5)초록 집 주인은 커피를 마신다 6)팰멀을 피우는 사람은 새를 키운다 7)노란 집 주인은 던힐을 피운다 8)가운데 집 주인은 우유를 마신다 9)노르웨이인은 첫 번째 집에 산다 10)블렌드를 피우는 사람은 고양이를 키우는 사람 옆에 산다 11)말을 키우는 사람은 던힐을 피우는 사람 옆에 산다 12)블루마스터를 피우는 사람은 맥주를 마신다 13)독일인은 프린스를 피운다 14)노르웨이인은 파란 집 옆에 산다 15)블렌드를 피우는 사람은 물을 마시는 사람 옆에 산다. 물고기는 누가 키울까요?',
 '독일인이 물고기를 키웁니다.',
 '["힌트 1: 표를 그려서 체계적으로 추론하세요", "힌트 2: 확실한 정보부터 채워나가세요", "힌트 3: 노르웨이인과 가운데 집부터 시작하세요"]',
 TRUE),

('REASONING', 8,
 '12개의 동일하게 생긴 동전이 있는데, 그 중 하나만 무게가 다릅니다(더 무겁거나 더 가볍습니다). 양팔 저울을 정확히 3번만 사용하여 어떤 동전이 다른지, 그리고 그것이 더 무거운지 가벼운지 알아내는 방법을 설명하세요.',
 '1차: 4개씩 3그룹으로 나눠 두 그룹을 비교. 균형이면 나머지 4개 중 하나, 불균형이면 8개 중 하나. 2차: 의심되는 그룹을 다시 나누어 비교하며 범위를 좁힘. 3차: 최종 2-3개 중 확인.',
 '["힌트 1: 동전을 3그룹으로 나누세요", "힌트 2: 각 비교에서 최대한 많은 정보를 얻으세요"]',
 TRUE);

-- 난이도 9-10: 최고난이도 추리
INSERT INTO training_problems (training_type, difficulty_level, problem_text, correct_answer, hints, is_active) VALUES
('REASONING', 9,
 '3명의 현자가 모자 게임을 합니다. 빨간 모자 3개와 파란 모자 2개가 있습니다. 각자에게 모자를 씌우고(나머지 2개는 숨김), 서로의 모자만 볼 수 있습니다. 자신의 모자 색깔을 맞추는 사람이 이깁니다. 현자 A가 한참을 생각하다가 "내 모자는 빨강이다"라고 말했습니다. A는 어떻게 알았을까요?',
 'A는 B와 C의 모자가 모두 파란색인 것을 보았습니다. 만약 자신의 모자도 파란색이라면 파란 모자 2개를 모두 사용한 것이므로, B나 C 중 한 명이 빠르게 답했을 것입니다. 하지만 아무도 답하지 않았으므로, 자신의 모자는 빨간색입니다.',
 '["힌트 1: A가 본 B와 C의 모자 색깔을 추론하세요", "힌트 2: 다른 현자들이 답하지 않은 이유를 생각하세요"]',
 TRUE),

('REASONING', 10,
 '100명의 수학자가 원형 테이블에 앉아있습니다. 각자 머리 위에 양의 정수가 적힌 카드가 있고, 자신의 숫자는 볼 수 없지만 다른 모든 사람의 숫자는 볼 수 있습니다. 100개 숫자의 합이 5000임을 모두 알고 있습니다. 사회자가 "자신의 숫자를 아는 사람?"이라고 물었을 때 아무도 손을 들지 않았습니다. 같은 질문을 반복했는데, 99번째 질문에서도 아무도 손을 들지 않았지만, 100번째 질문에서 모두가 동시에 손을 들었습니다. 각자의 숫자는 무엇일까요?',
 '모든 사람의 숫자는 50입니다. N번째 질문에서 모두 손을 들었다면, 모든 숫자가 N/2입니다. 100번째에 모두 손을 들었으므로 100/2=50입니다.',
 '["힌트 1: 왜 처음에는 아무도 알 수 없었을까요?", "힌트 2: 질문 횟수와 숫자의 관계를 찾으세요", "힌트 3: 만약 한 명의 숫자가 다르다면 어떻게 될까요?"]',
 TRUE);

-- 완료 메시지
SELECT '✅ V10 Migration: REASONING Training Type added successfully' AS Status;
